{"version":3,"sources":["../src/elementalist.js"],"names":["bootstrap","elements","initDockerSwarm","SWARM_HOST","host","process","env","advertiseAddr","startDockerRegistry","error","console","log","exitStatus","stderr","toString"],"mappings":";;;;;;QA4BsBA,S,GAAAA,S;;AA5BtB;;;;AAGA;;IAAYC,Q;;;;;;QACHA,Q,GAAAA,Q;;AAFT;;AAIA,SAASC,eAAT,GAA2B;AACzB,MAAI,EAAEC,YAAYC,IAAd,KAAuBC,QAAQC,GAAnC;AACA,MAAIC,gBAAgB,EAApB;AACA,MAAIH,IAAJ,EAAU;AACRG,oBAAgB,CAAC,kBAAD,EAAsB,GAAEH,IAAK,OAA7B,CAAhB;AACD;;AAED,SAAO,sBAAO,OAAP,EAAgB,MAAhB,EAAwB,GAAGG,aAA3B,CAAP;AACD;;AAED,SAASC,mBAAT,GAA+B;AAC7B,SAAO,sBACL,KADK,EAEL,IAFK,EAGL,IAHK,EAIL,WAJK,EAKL,QALK,EAML,UANK,EAOL,YAPK,CAAP;AASD;;AAEM,eAAeR,SAAf,GAA2B;AAChC,MAAI;AACF,UAAME,iBAAN;AACD,GAFD,CAEE,OAAOO,KAAP,EAAc;AACdC,YAAQC,GAAR,CAAYF,MAAMG,UAAlB,EAA8BH,MAAMI,MAAN,CAAaC,QAAb,CAAsB,OAAtB,CAA9B;AACD;;AAED,MAAI;AACF,UAAMN,qBAAN;AACD,GAFD,CAEE,OAAOC,KAAP,EAAc;AACdC,YAAQC,GAAR,CAAY,0BAAZ;AACD;AACF","file":"elementalist.js","sourcesContent":["import docker from './docker'\n\n// submodules\nimport * as elements from './elements'\nexport { elements }\n\nfunction initDockerSwarm() {\n  let { SWARM_HOST: host } = process.env\n  let advertiseAddr = []\n  if (host) {\n    advertiseAddr = ['--advertise-addr', `${host}:2377`]\n  }\n\n  return docker('swarm', 'init', ...advertiseAddr)\n}\n\nfunction startDockerRegistry() {\n  return docker(\n    'run',\n    '-d',\n    '-p',\n    '5000:5000',\n    '--name',\n    'registry',\n    'registry:2'\n  )\n}\n\nexport async function bootstrap() {\n  try {\n    await initDockerSwarm()\n  } catch (error) {\n    console.log(error.exitStatus, error.stderr.toString('utf-8'))\n  }\n\n  try {\n    await startDockerRegistry()\n  } catch (error) {\n    console.log('registry already running')\n  }\n}\n"]}